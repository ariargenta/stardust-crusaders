<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <title>Diagrama de bloques — WebGL demo (funciones y dependencias)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      --bg: #0b1220;
      --panel: #101a2b;
      --stroke: #6da8ff;
      --accent: #a7ffad;
      --text: #e6eefc;
      --muted: #9fb3d1;
      --warn: #ffd27d;
    }
    html, body {
      height: 100%;
      margin: 0;
      background: var(--bg);
      color: var(--text);
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
    }
    header {
      padding: 18px 22px;
      border-bottom: 1px solid #1f2c46;
      background: linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0));
      position: sticky;
      top: 0;
      z-index: 10;
    }
    h1 { font-size: 20px; margin: 0 0 4px 0; }
    p { margin: 0.25rem 0 0 0; color: var(--muted); }
    .canvas-wrap {
      overflow: auto;
      height: calc(100% - 70px);
    }
    svg { display: block; margin: 0; background: radial-gradient(1500px 800px at 20% 0%, #0e1830, #0b1220 60%); }
    .lane-title {
      fill: var(--muted);
      font-size: 13px;
      text-transform: uppercase;
      letter-spacing: .08em;
    }
    .box {
      fill: var(--panel);
      stroke: var(--stroke);
      stroke-width: 1.5;
      rx: 10; ry: 10;
      filter: drop-shadow(0 6px 10px rgba(0,0,0,.45));
    }
    .box text.title { font-weight: 600; font-size: 14px; }
    .box text.meta { fill: var(--muted); font-size: 12px; }
    .legend rect { rx: 8; ry: 8; }
    .arrow {
      stroke: var(--accent);
      stroke-width: 2;
      fill: none;
      marker-end: url(#arrowhead);
    }
    .arrow.alt { stroke: var(--warn); }
    .note { fill: var(--muted); font-size: 12px; }
    a.link { fill: #9ad0ff; }
  </style>
</head>
<body>
  <header>
    <h1>Diagrama de bloques — funciones y dependencias</h1>
    <p>Relaciones típicas entre archivos del tutorial WebGL: <code>webgl-demo.js</code>, <code>init-buffers.js</code> y <code>draw-scene.js</code>. Flechas = “usa/depende de”.</p>
  </header>
  <div class="canvas-wrap">
    <svg width="1400" height="860" viewBox="0 0 1400 860" xmlns="http://www.w3.org/2000/svg">
      <defs>
        <marker id="arrowhead" viewBox="0 0 10 10" refX="9" refY="5" markerWidth="7" markerHeight="7" orient="auto-start-reverse">
          <path d="M 0 0 L 10 5 L 0 10 z" fill="currentColor"></path>
        </marker>
      </defs>

      <!-- Swimlanes (por archivo) -->
      <g class="lane">
        <text class="lane-title" x="140" y="48">webgl-demo.js</text>
        <line x1="20" y1="60" x2="460" y2="60" stroke="#233556" stroke-width="1"/>
        <line x1="20" y1="820" x2="460" y2="820" stroke="#233556" stroke-width="1"/>
      </g>
      <g class="lane">
        <text class="lane-title" x="650" y="48">init-buffers.js</text>
        <line x1="520" y1="60" x2="880" y2="60" stroke="#233556" stroke-width="1"/>
        <line x1="520" y1="820" x2="880" y2="820" stroke="#233556" stroke-width="1"/>
      </g>
      <g class="lane">
        <text class="lane-title" x="1130" y="48">draw-scene.js</text>
        <line x1="940" y1="60" x2="1360" y2="60" stroke="#233556" stroke-width="1"/>
        <line x1="940" y1="820" x2="1360" y2="820" stroke="#233556" stroke-width="1"/>
      </g>

      <!-- Cajas (webgl-demo.js) -->
      <g class="box" transform="translate(60,110)">
        <rect width="360" height="90" />
        <text class="title" x="20" y="32">main()</text>
        <text class="meta"  x="20" y="56">Inicializa <tspan fill="#a7ffad">gl</tspan>, shaders, buffers y dispara <tspan fill="#ffd27d">drawScene</tspan>.</text>
      </g>

      <g class="box" transform="translate(60,250)">
        <rect width="360" height="90" />
        <text class="title" x="20" y="32">initShaderProgram(gl, vsSource, fsSource)</text>
        <text class="meta"  x="20" y="56">Compila shaders y enlaza el <tspan fill="#a7ffad">program</tspan>.</text>
      </g>

      <g class="box" transform="translate(60,390)">
        <rect width="360" height="90" />
        <text class="title" x="20" y="32">loadShader(gl, type, source)</text>
        <text class="meta"  x="20" y="56">Crea/compila un shader individual.</text>
      </g>

      <!-- Cajas (init-buffers.js) -->
      <g class="box" transform="translate(520,220)">
        <rect width="360" height="90" />
        <text class="title" x="20" y="32">initBuffers(gl)</text>
        <text class="meta"  x="20" y="56">Genera buffers (vértices/índices) usados para dibujar.</text>
      </g>

      <!-- Cajas (draw-scene.js) -->
      <g class="box" transform="translate(980,180)">
        <rect width="360" height="120" />
        <text class="title" x="20" y="32">drawScene(gl, programInfo, buffers)</text>
        <text class="meta"  x="20" y="56">Configura estado de WebGL, conecta atributos/uniformes y emite draw calls.</text>
        <text class="meta"  x="20" y="76">Consume <tspan fill="#a7ffad">programInfo</tspan> y <tspan fill="#a7ffad">buffers</tspan>.</text>
      </g>

      <!-- Recursos intermedios -->
      <g class="box" transform="translate(520,420)">
        <rect width="360" height="90" />
        <text class="title" x="20" y="32">programInfo</text>
        <text class="meta"  x="20" y="56">Ubicaciones de atributos/uniformes derivadas del programa.</text>
      </g>

      <g class="box" transform="translate(520,560)">
        <rect width="360" height="90" />
        <text class="title" x="20" y="32">buffers</text>
        <text class="meta"  x="20" y="56">VBOs/IBOs (posiciones, colores, etc.).</text>
      </g>

      <g class="box" transform="translate(60,560)">
        <rect width="360" height="90" />
        <text class="title" x="20" y="32">gl (WebGLRenderingContext)</text>
        <text class="meta"  x="20" y="56">Contexto obtenido del &lt;canvas&gt;.</text>
      </g>

      <!-- Flechas de dependencia -->
      <path class="arrow" d="M240,200 C240,230 240,230 240,240 L240,250" />
      <path class="arrow" d="M240,340 C240,360 240,360 240,370 L240,380" />
      <path class="arrow" d="M240,200 C240,210 400,210 520,265" /> <!-- main -> initBuffers -->
      <path class="arrow" d="M240,200 C240,210 900,210 980,220" /> <!-- main -> drawScene -->
      <path class="arrow" d="M240,605 C480,605 900,605 980,260" /> <!-- gl -> drawScene -->

      <path class="arrow" d="M240,295 C380,295 520,295 520,295" />  <!-- initShaderProgram <- main -->
      <path class="arrow" d="M240,435 C380,435 420,435 420,435 S460,435 520,465" /> <!-- loadShader -> programInfo (indirect a través de program) -->

      <path class="arrow alt" d="M420,295 C480,295 540,400 540,420" /> <!-- initShaderProgram -> programInfo -->
      <path class="arrow" d="M700,310 C700,340 700,520 700,560" /> <!-- initBuffers -> buffers -->
      <path class="arrow" d="M700,465 C880,465 1060,320 1060,300" /> <!-- programInfo -> drawScene -->
      <path class="arrow" d="M700,615 C900,615 1120,340 1120,300" /> <!-- buffers -> drawScene -->

      <!-- Leyenda -->
      <g class="legend" transform="translate(940,720)">
        <rect width="420" height="110" fill="#0f1830" stroke="#22406b" />
        <text x="20" y="28" class="title">Leyenda</text>
        <circle cx="34" cy="52" r="6" fill="none" stroke="var(--accent)" stroke-width="2"/>
        <text x="50" y="56" class="meta">Flecha verde: “usa / depende de”</text>
        <circle cx="34" cy="82" r="6" fill="none" stroke="var(--warn)" stroke-width="2"/>
        <text x="50" y="86" class="meta">Flecha amarilla: crea/deriva recurso intermedio</text>
      </g>

      <!-- Notas -->
      <text x="60" y="780" class="note">Tip: lee el diagrama de izquierda a derecha. <tspan>Las cajas centrales (programInfo, buffers) son artefactos producidos que </tspan><tspan>consumen drawScene().</tspan></text>
    </svg>
  </div>
</body>
</html>
